{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","scripts/index.js","scripts/app.html","node_modules/riot/riot.js"],"names":["require","mount","riot","tag","opts","self","this","on","socket","io","connect","data","console","log","update","model","addData","window","loopKeys","expr","b0","brackets","els","slice","length","match","key","pos","val","mkitem","item","_each","dom","parent","remAttr","checksum","template","outerHTML","root","parentNode","placeholder","document","createComment","tags","child","getTag","insertBefore","one","stub","removeChild","test","items","tmpl","isArray","JSON","stringify","Object","keys","map","frag","createDocumentFragment","i","j","unmount","_item","Tag","isLoop","appendChild","getTagName","walk","node","nodeType","_looped","_visited","setNamed","parseNamedElements","childTags","getAttribute","cachedTag","innerHTML","tagName","ptag","push","parseExpressions","expressions","addExpr","extra","indexOf","extend","type","nodeValue","attr","each","attributes","name","bool","split","value","impl","conf","updateOpts","el","toggle","isMount","evt","loopDom","observable","inherit","mkdom","fn","toLowerCase","TAG_ATTRIBUTES","_tag","isMounted","attrs","a","kv","setAttribute","replace","_id","fastAbs","Date","getTime","Math","random","replaceYield","trigger","mixin","arguments","mix","bind","init","call","firstChild","isInStub","keepRootTag","p","splice","undefined","off","setEventHandler","handler","e","event","which","charCode","keyCode","target","srcElement","currentTarget","ignored","preventDefault","returnValue","preventUpdate","insertTo","before","attrName","toString","inStub","createTextNode","style","display","len","isFunction","v","removeAttribute","nr","namedTag","src","obj","args","checkie","ieVersion","matches","exec","rootTag","mkEl","optgroupInnerHTML","optionInnerHTML","tbodyInnerHTML","nextSibling","createElement","$$","selector","ctx","querySelectorAll","Child","prototype","html","div","loops","opt","valRegx","selRegx","eachRegx","ifRegx","innerRegx","valuesMatch","selectedMatch","innerValue","eachMatch","ifMatch","labelRegx","elementRegx","tagRegx","labelMatch","elementMatch","tagMatch","innerContent","options","trim","innerOpt","tagImpl","RIOT_TAG","injectStyle","css","styleNode","head","styleSheet","cssText","_rendered","body","rs","mountTo","_innerHTML","virtualDom","version","settings","T_STRING","T_OBJECT","Array","_ts","win","documentMode","callbacks","events","typed","cb","arr","apply","fns","busy","concat","all","mixins","hash","loc","href","parser","path","emit","current","location","started","r","route","arg","stop","removeEventListener","detachEvent","start","addEventListener","attachEvent","orig","cachedBrackets","b","re","x","s","RegExp","source","global","extract","Function","join","n","pair","_","k","wrap","nonull","reVars","str","substrings","parts","sub","open","close","level","cache","addRiotTags","list","selectAllTags","pushTags","allTags","nodeList","_el","util","exports","module","define","amd"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","require('./app.html')\nrequire('riot').mount('productcard')","var riot = require('riot');\nriot.tag('productcard', '<section class=\"col-md-4\"> <section class=\"panel panel-default\"> <section class=\"panel-heading stbcolor-background seventh lead\"> { model.product.productname } </section> <section class=\"panel-body text-center\"> <h1>{ model.product.savings.periodicsavings }</h1> <h1>{ model.product.savings.onetimepayments }</h1> <section class=\"row\"> <section class=\"col-lg-4\"> <section class=\"panel panel-default\"> <section class=\"panel-heading\"> Demand </section> <section class=\"panel-body\"> { model.event.demands } </section> </section> </section> <section class=\"col-lg-4\"> <section class=\"panel panel-default\"> <section class=\"panel-heading\"> Offer </section> <section class=\"panel-body\"> { model.event.offers } </section> </section> </section> <section class=\"col-lg-4\"> <section class=\"panel panel-default\"> <section class=\"panel-heading\"> Accept </section> <section class=\"panel-body\"> { model.event.accepts } </section> </section> </section> </section> </section> <section class=\"panel-footer\"> <span>{ model.customer.gender } ({ model.customer.age }) { model.event.eventtype }</span> </section> </section> </section>', function(opts) {\n\n\tvar self = this;\n\tvar model = {};\n\n\tthis.on( 'mount', function() {\n\t\tvar socket = io.connect( \"http://localhost:3000\" );\n\t\tsocket.on('productevent', function( data ){\n\t\t\tconsole.log( \"Received data. Updating\", data );\n\t\t\tself.update( { model: data } );\t\n\t\t});\n\t});\n\n\taddData = function( data ) {\n\t\tself.update( { model: data } );\n\t};\n\n\n});","/* Riot v2.2.1, @license MIT, (c) 2015 Muut Inc. + contributors */\n\n;(function(window) {\n  'use strict'\n  var riot = { version: 'v2.2.1', settings: {} }\n\n  // This globals 'const' helps code size reduction\n\n  // for typeof == '' comparisons\n  var T_STRING = 'string'\n  var T_OBJECT = 'object'\n\n  // for IE8 and rest of the world\n  var isArray = Array.isArray || (function () {\n    var _ts = Object.prototype.toString\n    return function (v) { return _ts.call(v) === '[object Array]' }\n  })()\n\n  // Version# for IE 8-11, 0 for others\n  var ieVersion = (function (win) {\n    return (win && win.document || {}).documentMode | 0\n  })(window)\n\nriot.observable = function(el) {\n\n  el = el || {}\n\n  var callbacks = {},\n      _id = 0\n\n  el.on = function(events, fn) {\n    if (isFunction(fn)) {\n      fn._id = typeof fn._id == 'undefined' ? _id++ : fn._id\n\n      events.replace(/\\S+/g, function(name, pos) {\n        (callbacks[name] = callbacks[name] || []).push(fn)\n        fn.typed = pos > 0\n      })\n    }\n    return el\n  }\n\n  el.off = function(events, fn) {\n    if (events == '*') callbacks = {}\n    else {\n      events.replace(/\\S+/g, function(name) {\n        if (fn) {\n          var arr = callbacks[name]\n          for (var i = 0, cb; (cb = arr && arr[i]); ++i) {\n            if (cb._id == fn._id) { arr.splice(i, 1); i-- }\n          }\n        } else {\n          callbacks[name] = []\n        }\n      })\n    }\n    return el\n  }\n\n  // only single event supported\n  el.one = function(name, fn) {\n    function on() {\n      el.off(name, on)\n      fn.apply(el, arguments)\n    }\n    return el.on(name, on)\n  }\n\n  el.trigger = function(name) {\n    var args = [].slice.call(arguments, 1),\n        fns = callbacks[name] || []\n\n    for (var i = 0, fn; (fn = fns[i]); ++i) {\n      if (!fn.busy) {\n        fn.busy = 1\n        fn.apply(el, fn.typed ? [name].concat(args) : args)\n        if (fns[i] !== fn) { i-- }\n        fn.busy = 0\n      }\n    }\n\n    if (callbacks.all && name != 'all') {\n      el.trigger.apply(el, ['all', name].concat(args))\n    }\n\n    return el\n  }\n\n  return el\n\n}\nriot.mixin = (function() {\n  var mixins = {}\n\n  return function(name, mixin) {\n    if (!mixin) return mixins[name]\n    mixins[name] = mixin\n  }\n\n})()\n\n;(function(riot, evt, window) {\n\n  // browsers only\n  if (!window) return\n\n  var loc = window.location,\n      fns = riot.observable(),\n      win = window,\n      started = false,\n      current\n\n  function hash() {\n    return loc.href.split('#')[1] || ''\n  }\n\n  function parser(path) {\n    return path.split('/')\n  }\n\n  function emit(path) {\n    if (path.type) path = hash()\n\n    if (path != current) {\n      fns.trigger.apply(null, ['H'].concat(parser(path)))\n      current = path\n    }\n  }\n\n  var r = riot.route = function(arg) {\n    // string\n    if (arg[0]) {\n      loc.hash = arg\n      emit(arg)\n\n    // function\n    } else {\n      fns.on('H', arg)\n    }\n  }\n\n  r.exec = function(fn) {\n    fn.apply(null, parser(hash()))\n  }\n\n  r.parser = function(fn) {\n    parser = fn\n  }\n\n  r.stop = function () {\n    if (!started) return\n    win.removeEventListener ? win.removeEventListener(evt, emit, false) : win.detachEvent('on' + evt, emit)\n    fns.off('*')\n    started = false\n  }\n\n  r.start = function () {\n    if (started) return\n    win.addEventListener ? win.addEventListener(evt, emit, false) : win.attachEvent('on' + evt, emit)\n    started = true\n  }\n\n  // autostart the router\n  r.start()\n\n})(riot, 'hashchange', window)\n/*\n\n//// How it works?\n\n\nThree ways:\n\n1. Expressions: tmpl('{ value }', data).\n   Returns the result of evaluated expression as a raw object.\n\n2. Templates: tmpl('Hi { name } { surname }', data).\n   Returns a string with evaluated expressions.\n\n3. Filters: tmpl('{ show: !done, highlight: active }', data).\n   Returns a space separated list of trueish keys (mainly\n   used for setting html classes), e.g. \"show highlight\".\n\n\n// Template examples\n\ntmpl('{ title || \"Untitled\" }', data)\ntmpl('Results are { results ? \"ready\" : \"loading\" }', data)\ntmpl('Today is { new Date() }', data)\ntmpl('{ message.length > 140 && \"Message is too long\" }', data)\ntmpl('This item got { Math.round(rating) } stars', data)\ntmpl('<h1>{ title }</h1>{ body }', data)\n\n\n// Falsy expressions in templates\n\nIn templates (as opposed to single expressions) all falsy values\nexcept zero (undefined/null/false) will default to empty string:\n\ntmpl('{ undefined } - { false } - { null } - { 0 }', {})\n// will return: \" - - - 0\"\n\n*/\n\n\nvar brackets = (function(orig) {\n\n  var cachedBrackets,\n      r,\n      b,\n      re = /[{}]/g\n\n  return function(x) {\n\n    // make sure we use the current setting\n    var s = riot.settings.brackets || orig\n\n    // recreate cached vars if needed\n    if (cachedBrackets !== s) {\n      cachedBrackets = s\n      b = s.split(' ')\n      r = b.map(function (e) { return e.replace(/(?=.)/g, '\\\\') })\n    }\n\n    // if regexp given, rewrite it with current brackets (only if differ from default)\n    return x instanceof RegExp ? (\n        s === orig ? x :\n        new RegExp(x.source.replace(re, function(b) { return r[~~(b === '}')] }), x.global ? 'g' : '')\n      ) :\n      // else, get specific bracket\n      b[x]\n  }\n})('{ }')\n\n\nvar tmpl = (function() {\n\n  var cache = {},\n      reVars = /(['\"\\/]).*?[^\\\\]\\1|\\.\\w*|\\w*:|\\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\\b|function *\\()|([a-z_$]\\w*)/gi\n              // [ 1               ][ 2  ][ 3 ][ 4                                                                                  ][ 5       ]\n              // find variable names:\n              // 1. skip quoted strings and regexps: \"a b\", 'a b', 'a \\'b\\'', /a b/\n              // 2. skip object properties: .name\n              // 3. skip object literals: name:\n              // 4. skip javascript keywords\n              // 5. match var name\n\n  // build a template (or get it from cache), render with data\n  return function(str, data) {\n    return str && (cache[str] = cache[str] || tmpl(str))(data)\n  }\n\n\n  // create a template instance\n\n  function tmpl(s, p) {\n\n    // default template string to {}\n    s = (s || (brackets(0) + brackets(1)))\n\n      // temporarily convert \\{ and \\} to a non-character\n      .replace(brackets(/\\\\{/g), '\\uFFF0')\n      .replace(brackets(/\\\\}/g), '\\uFFF1')\n\n    // split string to expression and non-expresion parts\n    p = split(s, extract(s, brackets(/{/), brackets(/}/)))\n\n    return new Function('d', 'return ' + (\n\n      // is it a single expression or a template? i.e. {x} or <b>{x}</b>\n      !p[0] && !p[2] && !p[3]\n\n        // if expression, evaluate it\n        ? expr(p[1])\n\n        // if template, evaluate all expressions in it\n        : '[' + p.map(function(s, i) {\n\n            // is it an expression or a string (every second part is an expression)\n          return i % 2\n\n              // evaluate the expressions\n              ? expr(s, true)\n\n              // process string parts of the template:\n              : '\"' + s\n\n                  // preserve new lines\n                  .replace(/\\n/g, '\\\\n')\n\n                  // escape quotes\n                  .replace(/\"/g, '\\\\\"')\n\n                + '\"'\n\n        }).join(',') + '].join(\"\")'\n      )\n\n      // bring escaped { and } back\n      .replace(/\\uFFF0/g, brackets(0))\n      .replace(/\\uFFF1/g, brackets(1))\n\n    + ';')\n\n  }\n\n\n  // parse { ... } expression\n\n  function expr(s, n) {\n    s = s\n\n      // convert new lines to spaces\n      .replace(/\\n/g, ' ')\n\n      // trim whitespace, brackets, strip comments\n      .replace(brackets(/^[{ ]+|[ }]+$|\\/\\*.+?\\*\\//g), '')\n\n    // is it an object literal? i.e. { key : value }\n    return /^\\s*[\\w- \"']+ *:/.test(s)\n\n      // if object literal, return trueish keys\n      // e.g.: { show: isOpen(), done: item.done } -> \"show done\"\n      ? '[' +\n\n          // extract key:val pairs, ignoring any nested objects\n          extract(s,\n\n              // name part: name:, \"name\":, 'name':, name :\n              /[\"' ]*[\\w- ]+[\"' ]*:/,\n\n              // expression part: everything upto a comma followed by a name (see above) or end of line\n              /,(?=[\"' ]*[\\w- ]+[\"' ]*:)|}|$/\n              ).map(function(pair) {\n\n                // get key, val parts\n                return pair.replace(/^[ \"']*(.+?)[ \"']*: *(.+?),? *$/, function(_, k, v) {\n\n                  // wrap all conditional parts to ignore errors\n                  return v.replace(/[^&|=!><]+/g, wrap) + '?\"' + k + '\":\"\",'\n\n                })\n\n              }).join('')\n\n        + '].join(\" \").trim()'\n\n      // if js expression, evaluate as javascript\n      : wrap(s, n)\n\n  }\n\n\n  // execute js w/o breaking on errors or undefined vars\n\n  function wrap(s, nonull) {\n    s = s.trim()\n    return !s ? '' : '(function(v){try{v='\n\n        // prefix vars (name => data.name)\n        + (s.replace(reVars, function(s, _, v) { return v ? '(d.'+v+'===undefined?'+(typeof window == 'undefined' ? 'global.' : 'window.')+v+':d.'+v+')' : s })\n\n          // break the expression if its empty (resulting in undefined value)\n          || 'x')\n      + '}catch(e){'\n      + '}finally{return '\n\n        // default to empty string for falsy values except zero\n        + (nonull === true ? '!v&&v!==0?\"\":v' : 'v')\n\n      + '}}).call(d)'\n  }\n\n\n  // split string by an array of substrings\n\n  function split(str, substrings) {\n    var parts = []\n    substrings.map(function(sub, i) {\n\n      // push matched expression and part before it\n      i = str.indexOf(sub)\n      parts.push(str.slice(0, i), sub)\n      str = str.slice(i + sub.length)\n    })\n\n    // push the remaining part\n    return parts.concat(str)\n  }\n\n\n  // match strings between opening and closing regexp, skipping any inner/nested matches\n\n  function extract(str, open, close) {\n\n    var start,\n        level = 0,\n        matches = [],\n        re = new RegExp('('+open.source+')|('+close.source+')', 'g')\n\n    str.replace(re, function(_, open, close, pos) {\n\n      // if outer inner bracket, mark position\n      if (!level && open) start = pos\n\n      // in(de)crease bracket level\n      level += open ? 1 : -1\n\n      // if outer closing bracket, grab the match\n      if (!level && close != null) matches.push(str.slice(start, pos+close.length))\n\n    })\n\n    return matches\n  }\n\n})()\n\n// { key, i in items} -> { key, i, items }\nfunction loopKeys(expr) {\n  var b0 = brackets(0),\n      els = expr.slice(b0.length).match(/\\s*(\\S+?)\\s*(?:,\\s*(\\S)+)?\\s+in\\s+(.+)/)\n  return els ? { key: els[1], pos: els[2], val: b0 + els[3] } : { val: expr }\n}\n\nfunction mkitem(expr, key, val) {\n  var item = {}\n  item[expr.key] = key\n  if (expr.pos) item[expr.pos] = val\n  return item\n}\n\n\n/* Beware: heavy stuff */\nfunction _each(dom, parent, expr) {\n\n  remAttr(dom, 'each')\n\n  var template = dom.outerHTML,\n      root = dom.parentNode,\n      placeholder = document.createComment('riot placeholder'),\n      tags = [],\n      child = getTag(dom),\n      checksum\n\n  root.insertBefore(placeholder, dom)\n\n  expr = loopKeys(expr)\n\n  // clean template code\n  parent\n    .one('premount', function () {\n      if (root.stub) root = parent.root\n      // remove the original DOM node\n      dom.parentNode.removeChild(dom)\n    })\n    .on('update', function () {\n      var items = tmpl(expr.val, parent),\n          test\n\n      // object loop. any changes cause full redraw\n      if (!isArray(items)) {\n        test = checksum\n        checksum = items ? JSON.stringify(items) : ''\n        if (checksum === test) return\n\n        items = !items ? [] :\n          Object.keys(items).map(function (key) {\n            return mkitem(expr, key, items[key])\n          })\n      }\n\n      var frag = document.createDocumentFragment(),\n          i = tags.length,\n          j = items.length\n\n      // unmount leftover items\n      while (i > j) tags[--i].unmount()\n      tags.length = j\n\n      test = !checksum && !!expr.key\n      for (i = 0; i < j; ++i) {\n        var _item = test ? mkitem(expr, items[i], i) : items[i]\n\n        if (!tags[i]) {\n          // mount new\n          (tags[i] = new Tag({ tmpl: template }, {\n              parent: parent,\n              isLoop: true,\n              root: root,\n              item: _item\n            })\n          ).mount()\n\n          frag.appendChild(tags[i].root)\n        }\n        tags[i]._item = _item\n        tags[i].update(_item)\n      }\n\n      root.insertBefore(frag, placeholder)\n\n      if (child) parent.tags[getTagName(dom)] = tags\n\n    }).one('updated', function() {\n      var keys = Object.keys(parent)// only set new values\n      walk(root, function(node) {\n        // only set element node and not isLoop\n        if (node.nodeType == 1 && !node.isLoop && !node._looped) {\n          node._visited = false // reset _visited for loop node\n          node._looped = true // avoid set multiple each\n          setNamed(node, parent, keys)\n        }\n      })\n    })\n\n}\n\n\nfunction parseNamedElements(root, parent, childTags) {\n\n  walk(root, function(dom) {\n    if (dom.nodeType == 1) {\n      dom.isLoop = (dom.parentNode && dom.parentNode.isLoop || dom.getAttribute('each')) ? 1 : 0\n\n      // custom child tag\n      var child = getTag(dom)\n\n      if (child && !dom.isLoop) {\n        var tag = new Tag(child, { root: dom, parent: parent }, dom.innerHTML),\n            tagName = getTagName(dom),\n            ptag = parent,\n            cachedTag\n\n        while (!getTag(ptag.root)) {\n          if (!ptag.parent) break\n          ptag = ptag.parent\n        }\n\n        // fix for the parent attribute in the looped elements\n        tag.parent = ptag\n\n        cachedTag = ptag.tags[tagName]\n\n        // if there are multiple children tags having the same name\n        if (cachedTag) {\n          // if the parent tags property is not yet an array\n          // create it adding the first cached tag\n          if (!isArray(cachedTag))\n            ptag.tags[tagName] = [cachedTag]\n          // add the new nested tag to the array\n          ptag.tags[tagName].push(tag)\n        } else {\n          ptag.tags[tagName] = tag\n        }\n\n        // empty the child node once we got its template\n        // to avoid that its children get compiled multiple times\n        dom.innerHTML = ''\n        childTags.push(tag)\n      }\n\n      if (!dom.isLoop)\n        setNamed(dom, parent, [])\n    }\n\n  })\n\n}\n\nfunction parseExpressions(root, tag, expressions) {\n\n  function addExpr(dom, val, extra) {\n    if (val.indexOf(brackets(0)) >= 0) {\n      var expr = { dom: dom, expr: val }\n      expressions.push(extend(expr, extra))\n    }\n  }\n\n  walk(root, function(dom) {\n    var type = dom.nodeType\n\n    // text node\n    if (type == 3 && dom.parentNode.tagName != 'STYLE') addExpr(dom, dom.nodeValue)\n    if (type != 1) return\n\n    /* element */\n\n    // loop\n    var attr = dom.getAttribute('each')\n\n    if (attr) { _each(dom, tag, attr); return false }\n\n    // attribute expressions\n    each(dom.attributes, function(attr) {\n      var name = attr.name,\n        bool = name.split('__')[1]\n\n      addExpr(dom, attr.value, { attr: bool || name, bool: bool })\n      if (bool) { remAttr(dom, name); return false }\n\n    })\n\n    // skip custom tags\n    if (getTag(dom)) return false\n\n  })\n\n}\nfunction Tag(impl, conf, innerHTML) {\n\n  var self = riot.observable(this),\n      opts = inherit(conf.opts) || {},\n      dom = mkdom(impl.tmpl),\n      parent = conf.parent,\n      isLoop = conf.isLoop,\n      item = conf.item,\n      expressions = [],\n      childTags = [],\n      root = conf.root,\n      fn = impl.fn,\n      tagName = root.tagName.toLowerCase(),\n      attr = {},\n      loopDom,\n      TAG_ATTRIBUTES = /([\\w\\-]+)\\s?=\\s?['\"]([^'\"]+)[\"']/gim\n\n\n  if (fn && root._tag) {\n    root._tag.unmount(true)\n  }\n\n  // not yet mounted\n  this.isMounted = false\n\n  if (impl.attrs) {\n    var attrs = impl.attrs.match(TAG_ATTRIBUTES)\n\n    each(attrs, function(a) {\n      var kv = a.split(/\\s?=\\s?/)\n      root.setAttribute(kv[0], kv[1].replace(/['\"]/g, ''))\n    })\n\n  }\n\n  // keep a reference to the tag just created\n  // so we will be able to mount this tag multiple times\n  root._tag = this\n\n  // create a unique id to this tag\n  // it could be handy to use it also to improve the virtual dom rendering speed\n  this._id = fastAbs(~~(new Date().getTime() * Math.random()))\n\n  extend(this, { parent: parent, root: root, opts: opts, tags: {} }, item)\n\n  // grab attributes\n  each(root.attributes, function(el) {\n    var val = el.value\n    // remember attributes with expressions only\n    if (brackets(/\\{.*\\}/).test(val)) attr[el.name] = val\n  })\n\n  if (dom.innerHTML && !/select|select|optgroup|tbody|tr/.test(tagName))\n    // replace all the yield tags with the tag inner html\n    dom.innerHTML = replaceYield(dom.innerHTML, innerHTML)\n\n  // options\n  function updateOpts() {\n    // update opts from current DOM attributes\n    each(root.attributes, function(el) {\n      opts[el.name] = tmpl(el.value, parent || self)\n    })\n    // recover those with expressions\n    each(Object.keys(attr), function(name) {\n      opts[name] = tmpl(attr[name], parent || self)\n    })\n  }\n\n  this.update = function(data) {\n    extend(self, data)\n    updateOpts()\n    self.trigger('update', data)\n    update(expressions, self, data)\n    self.trigger('updated')\n  }\n\n  this.mixin = function() {\n    each(arguments, function(mix) {\n      mix = typeof mix == 'string' ? riot.mixin(mix) : mix\n      each(Object.keys(mix), function(key) {\n        // bind methods to self\n        if (key != 'init')\n          self[key] = typeof mix[key] == 'function' ? mix[key].bind(self) : mix[key]\n      })\n      // init method will be called automatically\n      if (mix.init) mix.init.bind(self)()\n    })\n  }\n\n  this.mount = function() {\n\n    updateOpts()\n\n    // initialiation\n    fn && fn.call(self, opts)\n\n    toggle(true)\n\n\n    // parse layout after init. fn may calculate args for nested custom tags\n    parseExpressions(dom, self, expressions)\n\n    if (!self.parent) self.update()\n\n    // internal use only, fixes #403\n    self.trigger('premount')\n\n    if (isLoop) {\n      // update the root attribute for the looped elements\n      self.root = root = loopDom = dom.firstChild\n    } else {\n      while (dom.firstChild) root.appendChild(dom.firstChild)\n      if (root.stub) self.root = root = parent.root\n    }\n    // if it's not a child tag we can trigger its mount event\n    if (!self.parent || self.parent.isMounted) {\n      self.isMounted = true\n      self.trigger('mount')\n    }\n    // otherwise we need to wait that the parent event gets triggered\n    else self.parent.one('mount', function() {\n      // avoid to trigger the `mount` event for the tags\n      // not visible included in an if statement\n      if (!isInStub(self.root)) {\n        self.parent.isMounted = self.isMounted = true\n        self.trigger('mount')\n      }\n    })\n  }\n\n\n  this.unmount = function(keepRootTag) {\n    var el = loopDom || root,\n        p = el.parentNode\n\n    if (p) {\n\n      if (parent) {\n        // remove this tag from the parent tags object\n        // if there are multiple nested tags with same name..\n        // remove this element form the array\n        if (isArray(parent.tags[tagName])) {\n          each(parent.tags[tagName], function(tag, i) {\n            if (tag._id == self._id)\n              parent.tags[tagName].splice(i, 1)\n          })\n        } else\n          // otherwise just delete the tag instance\n          parent.tags[tagName] = undefined\n      } else {\n        while (el.firstChild) el.removeChild(el.firstChild)\n      }\n\n      if (!keepRootTag)\n        p.removeChild(el)\n\n    }\n\n\n    self.trigger('unmount')\n    toggle()\n    self.off('*')\n    // somehow ie8 does not like `delete root._tag`\n    root._tag = null\n\n  }\n\n  function toggle(isMount) {\n\n    // mount/unmount children\n    each(childTags, function(child) { child[isMount ? 'mount' : 'unmount']() })\n\n    // listen/unlisten parent (events flow one way from parent to children)\n    if (parent) {\n      var evt = isMount ? 'on' : 'off'\n\n      // the loop tags will be always in sync with the parent automatically\n      if (isLoop)\n        parent[evt]('unmount', self.unmount)\n      else\n        parent[evt]('update', self.update)[evt]('unmount', self.unmount)\n    }\n  }\n\n  // named elements available for fn\n  parseNamedElements(dom, this, childTags)\n\n\n}\n\nfunction setEventHandler(name, handler, dom, tag, item) {\n\n  dom[name] = function(e) {\n\n    // cross browser event fix\n    e = e || window.event\n\n    if (!e.which) e.which = e.charCode || e.keyCode\n    if (!e.target) e.target = e.srcElement\n\n    // ignore error on some browsers\n    try {\n      e.currentTarget = dom\n    } catch (ignored) { '' }\n\n    e.item = tag._item ? tag._item : item\n\n    // prevent default behaviour (by default)\n    if (handler.call(tag, e) !== true && !/radio|check/.test(dom.type)) {\n      e.preventDefault && e.preventDefault()\n      e.returnValue = false\n    }\n\n    if (!e.preventUpdate) {\n      var el = item ? tag.parent : tag\n      el.update()\n    }\n\n  }\n\n}\n\n// used by if- attribute\nfunction insertTo(root, node, before) {\n  if (root) {\n    root.insertBefore(before, node)\n    root.removeChild(node)\n  }\n}\n\n// item = currently looped item\nfunction update(expressions, tag, item) {\n\n  each(expressions, function(expr, i) {\n\n    var dom = expr.dom,\n        attrName = expr.attr,\n        value = tmpl(expr.expr, tag),\n        parent = expr.dom.parentNode\n\n    if (value == null) value = ''\n\n    // leave out riot- prefixes from strings inside textarea\n    if (parent && parent.tagName == 'TEXTAREA') value = value.replace(/riot-/g, '')\n\n    // no change\n    if (expr.value === value) return\n    expr.value = value\n\n    // text node\n    if (!attrName) return dom.nodeValue = value.toString()\n\n    // remove original attribute\n    remAttr(dom, attrName)\n\n    // event handler\n    if (typeof value == 'function') {\n      setEventHandler(attrName, value, dom, tag, item)\n\n    // if- conditional\n    } else if (attrName == 'if') {\n      var stub = expr.stub\n\n      // add to DOM\n      if (value) {\n        if (stub) {\n          insertTo(stub.parentNode, stub, dom)\n          dom.inStub = false\n          // avoid to trigger the mount event if the tags is not visible yet\n          // maybe we can optimize this avoiding to mount the tag at all\n          if (!isInStub(dom)) {\n            walk(dom, function(el) {\n              if (el._tag && !el._tag.isMounted) el._tag.isMounted = !!el._tag.trigger('mount')\n            })\n          }\n        }\n      // remove from DOM\n      } else {\n        stub = expr.stub = stub || document.createTextNode('')\n        insertTo(dom.parentNode, dom, stub)\n        dom.inStub = true\n      }\n    // show / hide\n    } else if (/^(show|hide)$/.test(attrName)) {\n      if (attrName == 'hide') value = !value\n      dom.style.display = value ? '' : 'none'\n\n    // field value\n    } else if (attrName == 'value') {\n      dom.value = value\n\n    // <img src=\"{ expr }\">\n    } else if (attrName.slice(0, 5) == 'riot-' && attrName != 'riot-tag') {\n      attrName = attrName.slice(5)\n      value ? dom.setAttribute(attrName, value) : remAttr(dom, attrName)\n\n    } else {\n      if (expr.bool) {\n        dom[attrName] = value\n        if (!value) return\n        value = attrName\n      }\n\n      if (typeof value != 'object') dom.setAttribute(attrName, value)\n\n    }\n\n  })\n\n}\n\nfunction each(els, fn) {\n  for (var i = 0, len = (els || []).length, el; i < len; i++) {\n    el = els[i]\n    // return false -> remove current item during loop\n    if (el != null && fn(el, i) === false) i--\n  }\n  return els\n}\n\nfunction isFunction(v) {\n  return typeof v === 'function' || false   // avoid IE problems\n}\n\nfunction remAttr(dom, name) {\n  dom.removeAttribute(name)\n}\n\nfunction fastAbs(nr) {\n  return (nr ^ (nr >> 31)) - (nr >> 31)\n}\n\nfunction getTagName(dom) {\n  var child = getTag(dom),\n    namedTag = dom.getAttribute('name'),\n    tagName = namedTag && namedTag.indexOf(brackets(0)) < 0 ? namedTag : child.name\n\n  return tagName\n}\n\nfunction extend(src) {\n  var obj, args = arguments\n  for (var i = 1; i < args.length; ++i) {\n    if ((obj = args[i])) {\n      for (var key in obj) {      // eslint-disable-line guard-for-in\n        src[key] = obj[key]\n      }\n    }\n  }\n  return src\n}\n\nfunction mkdom(template) {\n  var checkie = ieVersion && ieVersion < 10,\n      matches = /^\\s*<([\\w-]+)/.exec(template),\n      tagName = matches ? matches[1].toLowerCase() : '',\n      rootTag = (tagName === 'th' || tagName === 'td') ? 'tr' :\n                (tagName === 'tr' ? 'tbody' : 'div'),\n      el = mkEl(rootTag)\n\n  el.stub = true\n\n  if (checkie) {\n    if (tagName === 'optgroup')\n      optgroupInnerHTML(el, template)\n    else if (tagName === 'option')\n      optionInnerHTML(el, template)\n    else if (rootTag !== 'div')\n      tbodyInnerHTML(el, template, tagName)\n    else\n      checkie = 0\n  }\n  if (!checkie) el.innerHTML = template\n\n  return el\n}\n\nfunction walk(dom, fn) {\n  if (dom) {\n    if (fn(dom) === false) walk(dom.nextSibling, fn)\n    else {\n      dom = dom.firstChild\n\n      while (dom) {\n        walk(dom, fn)\n        dom = dom.nextSibling\n      }\n    }\n  }\n}\n\nfunction isInStub(dom) {\n  while (dom) {\n    if (dom.inStub) return true\n    dom = dom.parentNode\n  }\n  return false\n}\n\nfunction mkEl(name) {\n  return document.createElement(name)\n}\n\nfunction replaceYield (tmpl, innerHTML) {\n  return tmpl.replace(/<(yield)\\/?>(<\\/\\1>)?/gim, innerHTML || '')\n}\n\nfunction $$(selector, ctx) {\n  return (ctx || document).querySelectorAll(selector)\n}\n\nfunction inherit(parent) {\n  function Child() {}\n  Child.prototype = parent\n  return new Child()\n}\n\nfunction setNamed(dom, parent, keys) {\n  each(dom.attributes, function(attr) {\n    if (dom._visited) return\n    if (attr.name === 'id' || attr.name === 'name') {\n      dom._visited = true\n      var p, v = attr.value\n      if (~keys.indexOf(v)) return\n\n      p = parent[v]\n      if (!p)\n        parent[v] = dom\n      else\n        isArray(p) ? p.push(dom) : (parent[v] = [p, dom])\n    }\n  })\n}\n/**\n *\n * Hacks needed for the old internet explorer versions [lower than IE10]\n *\n */\n\nfunction tbodyInnerHTML(el, html, tagName) {\n  var div = mkEl('div'),\n      loops = /td|th/.test(tagName) ? 3 : 2,\n      child\n\n  div.innerHTML = '<table>' + html + '</table>'\n  child = div.firstChild\n\n  while (loops--) {\n    child = child.firstChild\n  }\n\n  el.appendChild(child)\n\n}\n\nfunction optionInnerHTML(el, html) {\n  var opt = mkEl('option'),\n      valRegx = /value=[\\\"'](.+?)[\\\"']/,\n      selRegx = /selected=[\\\"'](.+?)[\\\"']/,\n      eachRegx = /each=[\\\"'](.+?)[\\\"']/,\n      ifRegx = /if=[\\\"'](.+?)[\\\"']/,\n      innerRegx = />([^<]*)</,\n      valuesMatch = html.match(valRegx),\n      selectedMatch = html.match(selRegx),\n      innerValue = html.match(innerRegx),\n      eachMatch = html.match(eachRegx),\n      ifMatch = html.match(ifRegx)\n\n  if (innerValue) {\n    opt.innerHTML = innerValue[1]\n  } else {\n    opt.innerHTML = html\n  }\n\n  if (valuesMatch) {\n    opt.value = valuesMatch[1]\n  }\n\n  if (selectedMatch) {\n    opt.setAttribute('riot-selected', selectedMatch[1])\n  }\n\n  if (eachMatch) {\n    opt.setAttribute('each', eachMatch[1])\n  }\n\n  if (ifMatch) {\n    opt.setAttribute('if', ifMatch[1])\n  }\n\n  el.appendChild(opt)\n}\n\nfunction optgroupInnerHTML(el, html) {\n  var opt = mkEl('optgroup'),\n      labelRegx = /label=[\\\"'](.+?)[\\\"']/,\n      elementRegx = /^<([^>]*)>/,\n      tagRegx = /^<([^ \\>]*)/,\n      labelMatch = html.match(labelRegx),\n      elementMatch = html.match(elementRegx),\n      tagMatch = html.match(tagRegx),\n      innerContent = html\n\n  if (elementMatch) {\n    var options = html.slice(elementMatch[1].length+2, -tagMatch[1].length-3).trim()\n    innerContent = options\n  }\n\n  if (labelMatch) {\n    opt.setAttribute('riot-label', labelMatch[1])\n  }\n\n  if (innerContent) {\n    var innerOpt = mkEl('div')\n\n    optionInnerHTML(innerOpt, innerContent)\n\n    opt.appendChild(innerOpt.firstChild)\n  }\n\n  el.appendChild(opt)\n}\n\n/*\n Virtual dom is an array of custom tags on the document.\n Updates and unmounts propagate downwards from parent to children.\n*/\n\nvar virtualDom = [],\n    tagImpl = {},\n    styleNode\n\nvar RIOT_TAG = 'riot-tag'\n\nfunction getTag(dom) {\n  return tagImpl[dom.getAttribute(RIOT_TAG) || dom.tagName.toLowerCase()]\n}\n\nfunction injectStyle(css) {\n\n  styleNode = styleNode || mkEl('style')\n\n  if (!document.head) return\n\n  if (styleNode.styleSheet)\n    styleNode.styleSheet.cssText += css\n  else\n    styleNode.innerHTML += css\n\n  if (!styleNode._rendered)\n    if (styleNode.styleSheet) {\n      document.body.appendChild(styleNode)\n    } else {\n      var rs = $$('style[type=riot]')[0]\n      if (rs) {\n        rs.parentNode.insertBefore(styleNode, rs)\n        rs.parentNode.removeChild(rs)\n      } else {\n        document.head.appendChild(styleNode)\n      }\n    }\n\n  styleNode._rendered = true\n\n}\n\nfunction mountTo(root, tagName, opts) {\n  var tag = tagImpl[tagName],\n      // cache the inner HTML to fix #855\n      innerHTML = root._innerHTML = root._innerHTML || root.innerHTML\n\n  // clear the inner html\n  root.innerHTML = ''\n\n  if (tag && root) tag = new Tag(tag, { root: root, opts: opts }, innerHTML)\n\n  if (tag && tag.mount) {\n    tag.mount()\n    virtualDom.push(tag)\n    return tag.on('unmount', function() {\n      virtualDom.splice(virtualDom.indexOf(tag), 1)\n    })\n  }\n\n}\n\nriot.tag = function(name, html, css, attrs, fn) {\n  if (isFunction(attrs)) {\n    fn = attrs\n    if (/^[\\w\\-]+\\s?=/.test(css)) {\n      attrs = css\n      css = ''\n    } else attrs = ''\n  }\n  if (css) {\n    if (isFunction(css)) fn = css\n    else injectStyle(css)\n  }\n  tagImpl[name] = { name: name, tmpl: html, attrs: attrs, fn: fn }\n  return name\n}\n\nriot.mount = function(selector, tagName, opts) {\n\n  var els,\n      allTags,\n      tags = []\n\n  // helper functions\n\n  function addRiotTags(arr) {\n    var list = ''\n    each(arr, function (e) {\n      list += ', *[riot-tag=\"'+ e.trim() + '\"]'\n    })\n    return list\n  }\n\n  function selectAllTags() {\n    var keys = Object.keys(tagImpl)\n    return keys + addRiotTags(keys)\n  }\n\n  function pushTags(root) {\n    if (root.tagName) {\n      if (tagName && !root.getAttribute(RIOT_TAG))\n        root.setAttribute(RIOT_TAG, tagName)\n\n      var tag = mountTo(root,\n        tagName || root.getAttribute(RIOT_TAG) || root.tagName.toLowerCase(), opts)\n\n      if (tag) tags.push(tag)\n    }\n    else if (root.length) {\n      each(root, pushTags)   // assume nodeList\n    }\n  }\n\n  // ----- mount code -----\n\n  if (typeof tagName === T_OBJECT) {\n    opts = tagName\n    tagName = 0\n  }\n\n  // crawl the DOM to find the tag\n  if (typeof selector === T_STRING) {\n    if (selector === '*') {\n      // select all the tags registered\n      // and also the tags found with the riot-tag attribute set\n      selector = allTags = selectAllTags()\n    } else {\n      // or just the ones named like the selector\n      selector += addRiotTags(selector.split(','))\n    }\n    els = $$(selector)\n  }\n  else\n    // probably you have passed already a tag or a NodeList\n    els = selector\n\n  // select all the registered and mount them inside their root elements\n  if (tagName === '*') {\n    // get all custom tags\n    tagName = allTags || selectAllTags()\n    // if the root els it's just a single tag\n    if (els.tagName) {\n      els = $$(tagName, els)\n    } else {\n      // select all the children for all the different root elements\n      var nodeList = []\n      each(els, function (_el) {\n        nodeList.push($$(tagName, _el))\n      })\n      els = nodeList\n    }\n    // get rid of the tagName\n    tagName = 0\n  }\n\n  if (els.tagName)\n    pushTags(els)\n  else\n    each(els, pushTags)\n\n  return tags\n}\n\n// update everything\nriot.update = function() {\n  return each(virtualDom, function(tag) {\n    tag.update()\n  })\n}\n\n// @deprecated\nriot.mountTo = riot.mount\n\n\n  // share methods for other riot parts, e.g. compiler\n  riot.util = { brackets: brackets, tmpl: tmpl }\n\n  // support CommonJS, AMD & browser\n  if (typeof exports === 'object')\n    module.exports = riot\n  else if (typeof define === 'function' && define.amd)\n    define(function() { return riot })\n  else\n    window.riot = riot\n\n})(typeof window != 'undefined' ? window : undefined);\n"]}